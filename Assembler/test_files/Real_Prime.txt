push 0x200      #001000 1000000000
st 0            #010010 0000000000
call RELPRIME   #110010 0000000101
ld -1           #101111 1111111111
exit            #000000 0000000000

RELPRIME:

mdsp -1		    #100110 1111111111
pushi 2		    #000110 0000000010
st 0		    #010010 0000000000
mdsp -2		    #100110 1111111110
ld 2		    #101111 0000000010
st 1		    #010010 0000000001
ld 3		    #101111 0000000011
st 0		    #010010 0000000000
call GCD		#110010 0000011010

LOOP_1:
ld -1		    #101111 1111111111
pushi 1		    #000110 0000000001
cmp		        #111010 0000000000
beq DONE		#110001 0000000100
ld 0		    #101111 0000000000
addi 1		    #100001 0000000001
st 0		    #010010 0000000000
j LOOP_1		#101010 0000001110

DONE:
ld 0		    #101111 0000000000
mdsp 2		    #100110 0000000010
st -1		    #010010 1111111111
ret		        #001010 0000000000

GCD: 
ld 0		    #101111 0000000000
pushi 0		    #000110 0000000000
cmp		        #111010 0000000000
beq RET_B		#110001 0000010110

LOOP_2:
ld 1		    #101111 0000000001
pushi 0		    #000110 0000000000
cmp		        #111010 0000000000
beq RET_A		#110001 0000001110
ld 0		    #101111 0000000000
ld 1		    #101111 0000000001
cmp		        #111010 0000000000
bgt ELSE		#110000 0000000101
ld 1		    #101111 0000000001
ld 0		    #101111 0000000000
sub		        #010011 0000000000
st 1		    #010010 0000000001
j END		    #101010 0000101111

ELSE:
ld 0		    #101111 0000000000
ld 1		    #101111 0000000001
sub		        #010011 0000000000
st 0		    #010010 0000000000

END:
j LOOP_2	    #101010 0000011110

RET_A:
ld 0		    #101111 0000000000
mdsp 2		    #100110 0000000010
st -1		    #010010 1111111111
ret		        #001010 0000000000

RET_B:
ld 1		    #101111 0000000001
mdsp 2		    #100110 0000000010
st -1		    #010010 1111111111
ret		        #001010 0000000000